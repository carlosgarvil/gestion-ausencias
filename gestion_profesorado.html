<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <title>Gestión de ausencias - IES Polígono Sur</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />
  <link rel="apple-touch-icon" sizes="180x180" href="img/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="img/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="img/favicon-16x16.png" />
  <link rel="shortcut icon" href="img/favicon.ico" />
  <meta name="msapplication-TileColor" content="#2b5797" />
  <meta name="msapplication-TileImage" content="img/android-chrome-192x192.png" />
  <meta name="theme-color" content="#ffffff" />
</head>

<body>
  <div id="app">
    <h1>Gestión de ausencias del profesorado</h1>

    <section id="login-section" v-if="!isLoggedIn">
      <h2>Acceso</h2>
      <form @submit.prevent="handleLogin">
        <label>
          Correo
          <input type="email" v-model="loginForm.email" required />
        </label>
        <label>
          Contraseña
          <input type="password" v-model="loginForm.password" required />
        </label>
        <button type="submit">Entrar</button>
        <div v-if="loginMessage" class="message" :class="loginMessageType">{{ loginMessage }}</div>
      </form>
    </section>

    <section id="app-section" v-else>
      <header class="app-header">
        <div class="header-left">
          <span class="session-text">
            Sesión iniciada como <strong>{{ userEmail }}</strong>
          </span>
        </div>
        <button id="btn-logout" type="button" class="btn-logout" @click="handleLogout">Cerrar sesión</button>
      </header>

      <nav class="top-nav">
        <a class="nav-link" href="index.html">Ausencias</a>
        <a class="nav-link" href="panel.html">Panel</a>
        <a class="nav-link" href="justificaciones.html">Justificantes</a>
        <a class="nav-link" href="profesorado.html">Profesorado</a>
        <a class="nav-link active" href="gestion_profesorado.html">Gestión del profesorado</a>
        <a class="nav-link" href="permisos.html">Permisos</a>
        <a class="nav-link" href="ayuda.html">Ayuda</a>
      </nav>

      <section id="substitutions-section">
        <h2>Gestión del profesorado</h2>
        <p>
          Desde aquí puedes crear nuevas incorporaciones copiando un horario existente o eliminar profesorado y sus
          horarios asociados en la base de datos.
        </p>

        <div class="substitutions-layout">
          <div class="substitutions-block">
            <h3>Crear nuevo profesor desde titular</h3>
            <form id="substitution-form" @submit.prevent="handleSubstitutionSubmit">
              <label>
                Profesor titular
                <select v-model="substitutionForm.teacher" required>
                  <option value="">Selecciona…</option>
                  <option v-for="teacher in teachers" :key="teacher.name" :value="teacher.name">{{ teacher.name }}
                  </option>
                </select>
              </label>

              <label>
                Nombre del nuevo profesor (Apellidos, Nombre)
                <input type="text" v-model="substitutionForm.newTeacherName" required />
              </label>

              <label>
                Correo @iespoligonosur.org
                <input type="email" v-model="substitutionForm.newTeacherEmail" required />
              </label>

              <button type="submit" class="btn-save" :disabled="substitutionSaving">Copiar horario al nuevo
                profesor</button>
              <div v-if="substitutionMessage" class="message" :class="substitutionMessageType">
                {{ substitutionMessage }}
              </div>
            </form>
          </div>

          <div class="substitutions-block">
            <h3>Eliminar profesorado</h3>
            <form id="delete-teacher-form" @submit.prevent="handleTeacherDelete">
              <label>
                Profesor/a a eliminar
                <select v-model="deleteTeacherName" required>
                  <option value="">Selecciona…</option>
                  <option v-for="teacher in teachers" :key="`delete-${teacher.name}`" :value="teacher.name">
                    {{ teacher.name }}
                  </option>
                </select>
              </label>

              <button type="submit" class="btn-delete" :disabled="deleteTeacherSaving">
                Eliminar profesor/a
              </button>
              <div v-if="deleteTeacherMessage" class="message" :class="deleteTeacherMessageType">
                {{ deleteTeacherMessage }}
              </div>
            </form>
          </div>
        </div>
      </section>
    </section>
  </div>

  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="script.js"></script>
</body>

</html>



